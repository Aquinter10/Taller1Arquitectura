{% extends 'base2.html' %}
{% block content %}
{% load static %}
<link rel="stylesheet" href="{% static 'chatbot.css' %}">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chatbot</title>
    <script src="https://code.jquery.com/jquery-3.1.1.min.js"   integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8="   crossorigin="anonymous"></script>
    <script src="{% static 'chatbot.js' %}"></script>    
    <script>
        $(document).ready(function(){

setInterval(function(){
    $.ajax({
        type: 'GET',
        url : "/getMessages/{{room}}/",
        success: function(response){
            console.log(response);
            $("#display").empty();
            for (var key in response.messages)
            {
                var temp="<div class='container darker'><b>"+response.messages[key].id_user__name+"</b><p>"+response.messages[key].content+"</p><span class='time-left'>"+response.messages[key].time+"</span></div>";
                $("#display").append(temp);
            }
        },
        error: function(response){
            alert('An error occured')
        }
    });
},1000);
})
    </script>    
</head>
<body>
    <div class="contenedor">
        <div class="chat-container">
            <div id="display"></div>
            <form method="POST" id="post-form">
                {% csrf_token %}
                <input type="hidden" name="username" id="username" value="{{username}}">
                <input type="hidden" name="chat_id" id="chat_id" value="{{chat.id_chat}}">
                <input type="text" name="message" id="message" placeholder="Escribe tus sintomas...">
                <input type="submit" id = 'Send' value="Send">
                </form>
        </div>
    </div>
    <div>{{ mensaje }}</div>
</body>
</html>
{% endblock content %}